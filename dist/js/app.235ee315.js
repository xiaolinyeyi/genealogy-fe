(function(){"use strict";var e={5170:function(e,t,l){var a=l(9242),n=l(3396);const i=(0,n._)("h1",null,"西同下赵氏家谱",-1);function o(e,t,l,a,o,r){const s=(0,n.up)("navigation-bar"),u=(0,n.up)("router-view");return(0,n.wg)(),(0,n.iD)(n.HY,null,[i,(0,n._)("div",null,[a.globalVars.allPeople?((0,n.wg)(),(0,n.j4)(s,{key:0})):(0,n.kq)("",!0),(0,n.Wm)(u)])],64)}const r=(0,n.Uk)("家训家规"),s=(0,n.Uk)("家族传承"),u=(0,n.Uk)("家庭详情"),d=(0,n.Uk)("供案");function h(e,t,l,a,i,o){const h=(0,n.up)("el-menu-item"),c=(0,n.up)("el-menu");return(0,n.wg)(),(0,n.j4)(c,{mode:"horizontal","default-active":e.$route.path,router:"true"},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{index:"/home"},{default:(0,n.w5)((()=>[r])),_:1}),(0,n.Wm)(h,{index:"/tree"},{default:(0,n.w5)((()=>[s])),_:1}),(0,n.Wm)(h,{index:"/table"},{default:(0,n.w5)((()=>[u])),_:1}),(0,n.Wm)(h,{index:"/sacrifice"},{default:(0,n.w5)((()=>[d])),_:1})])),_:1},8,["default-active"])}var c={},p=l(89);const f=(0,p.Z)(c,[["render",h]]);var m=f,g=l(7535),y=l(4870),b={name:"App",data:function(){return{}},computed:{cacheKey:function(){return"genealogy.cache"}},components:{NavigationBar:m},created:function(){this.createCacheIfNeeded();let e=JSON.parse(localStorage.getItem(this.cacheKey)),t=e.local.userInfo;void 0==t&&(t=prompt("请输入分配的密码："),e.local.userInfo=t);let l="";void 0!=e.response&&void 0!=e.response.version&&(l=e.response.version),this.getPeopleInfo({userInfo:t,version:l},(t=>t.userLevel<0?(alert("用户信息有误，无权查看"),void localStorage.removeItem(this.cacheKey)):void 0!=t.error?(alert(t.error),void localStorage.removeItem(this.cacheKey)):void(l!=t.version?(e.response=t,localStorage.setItem(this.cacheKey,JSON.stringify(e)),this.globalVars.allPeople=t.data,this.allPeople=t.data,console.log("没有命中缓存"),console.log(this.allPeople)):(console.log("命中缓存"),this.globalVars.allPeople=e.response.data,this.allPeople=e.response.data,console.log(this.allPeople)))))},setup(){const e=(0,y.qj)({allPeople:{}});return(0,n.JJ)("globalVars",e),{globalVars:e}},methods:{createCacheIfNeeded:function(){let e=JSON.parse(localStorage.getItem(this.cacheKey)),t=!1;void 0==e&&(e=new Map,t=!0),void 0==e.local&&(e.local=new Map,t=!0),t&&localStorage.setItem(this.cacheKey,JSON.stringify(e))},getPeopleInfo:function(e,t){const l="https://7br8y2rw0tat2.cfc-execute.bj.baidubce.com/genealogy";(0,g.R)(l,{callbackQuery:"callback",callbackName:"callback",cmd:"fetch",userInfo:e.userInfo,version:e.version}).then((e=>{t(e)}))}}};const w=(0,p.Z)(b,[["render",o]]);var v=w,D=l(1033),k=(l(4415),l(2483));const P=e=>((0,n.dD)("data-v-2ddffb22"),e=e(),(0,n.Cn)(),e),I=P((()=>(0,n._)("h2",null,"族训",-1))),O=P((()=>(0,n._)("div",null," 几长者共谋，立家案百愿呼。村东老茔穴尽水，各支于清末时，民故，觅佳城立墓，分而仰先。为聚祖力量，歌祖宗功德，永言孝思，而立我族家案。定立我族家规家训，以规范后人；记载族人功德，以勉励后人。强优我族，众志成城。虽社稷传优去弼，过己训群，优秀后人，贡献社会。再者，名讳不乱，长幼有序，扬我族威。长辈存载力，宜子宜孙，千古留芳 ",-1))),_=P((()=>(0,n._)("h2",null,"字辈表",-1)));function x(e,t,l,a,i,o){const r=(0,n.up)("el-table-column"),s=(0,n.up)("el-table"),u=(0,n.up)("el-col"),d=(0,n.up)("el-row");return(0,n.wg)(),(0,n.iD)(n.HY,null,[I,O,_,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.isMobile?[0,1]:[0],(e=>((0,n.wg)(),(0,n.j4)(d,{gutter:10,key:e},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.isMobile?[0,1]:[0,1,2,3],(e=>((0,n.wg)(),(0,n.j4)(u,{span:i.isMobile?10:6,key:e},{default:(0,n.w5)((()=>[(0,n.Wm)(s,{data:this.getZibeiByGroup(e),border:!0},{default:(0,n.w5)((()=>[(0,n.Wm)(r,{prop:"gen",label:"代数"}),(0,n.Wm)(r,{prop:"name",label:"辈字"})])),_:2},1032,["data"])])),_:2},1032,["span"])))),128))])),_:2},1024)))),128))],64)}var S={data(){return{zibei:["子","林","壮","连","喜","富","文","进","彦","晓","春","龙","勤","学","贤","博","雅","如","清","淳","天","乾","坤","浩","魁","星","盖","端","正","方","忠","谦","礼","聪","惠","敏","秉","权","殿","修"],isMobile:!1}},methods:{getZibeiByGroup:function(e){let t=[];for(var l=10*e;l<10*(e+1);l++)t.push({gen:"第"+(l+1)+"代",name:this.zibei[l]});return t}},mounted(){console.log("home mounted"),window.innerWidth<=768?this.isMobile=!0:this.isMobile=!1}};const W=(0,p.Z)(S,[["render",x],["__scopeId","data-v-2ddffb22"]]);var j=W,N=l(7139);const V={style:{width:"5000px",height:"1400px"}},J={style:{width:"20px",height:"75px"}},F={key:1},z={key:1};function Y(e,t,l,a,i,o){const r=(0,n.up)("router-link"),s=(0,n.up)("vue3-tree-org"),u=(0,n.up)("el-scrollbar");return(0,n.wg)(),(0,n.j4)(u,null,{default:(0,n.w5)((()=>[(0,n._)("div",V,[i.rootNode?((0,n.wg)(),(0,n.j4)(s,{key:0,data:i.rootNode,disabled:!0,horizontal:!1,collapsable:!1,scalable:!1},{default:(0,n.w5)((({node:e})=>[(0,n._)("div",J,[o.peopleIsFamilyOwnerWithID(e.id)?((0,n.wg)(),(0,n.j4)(r,{key:0,to:{name:"table",query:{id:e.id}}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,N.zw)(e.label),1)])),_:2},1032,["to"])):((0,n.wg)(),(0,n.iD)("div",F,(0,N.zw)(e.label),1))])])),_:1},8,["data"])):((0,n.wg)(),(0,n.iD)("div",z,"数据加载中"))])])),_:1})}class C{constructor(e){if(null==e)return null;this.metadata=e,this.id=e.id,this.genID=e.genID,this.name=e.name,this.sexDes=this.sexDes(),this.nativePlace=e.nativePlace,this.birthdayDes=this.birthdayDes(),this.deathdayDes=this.deathdayDes(),this.educational=e.educational,this.lastJob=this.lastJob(),this.lastHabitation=this.lastHabitation(),this.extDes=this.extDes()}isFamilyOwner(){return 0!=this.metadata.sex&&(null!=this.metadata.spouses&&this.metadata.spouses.length>0||null!=this.metadata.children&&this.metadata.children.length>0)}isDead(){return void 0!=this.deathdayDes&&""!=this.deathdayDes}sexDes(){return 0==this.metadata.sex?"女":"男"}birthdayDes(){if(null!=this.metadata.ext&&null!=this.metadata.ext[0]["birthday"])return this.metadata.ext[0]["birthday"];if(null==this.metadata.birthday)return"不详";{let e=new Date(this.metadata.birthday.iso);return e.getFullYear()}}deathdayDes(){if(null!=this.metadata.deathday){let e=new Date(this.metadata.deathday.iso);return e.getFullYear()}if(null==this.metadata.birthday)return this.isSameFamily()&&"number"!=typeof this.birthdayDes||"number"!=typeof this.birthdayDes&&this.metadata.genID<6?"不详":"";{let e=new Date(this.metadata.birthday.iso).getFullYear(),t=(new Date).getFullYear();if(t-e>100)return"不详"}}lastPost(){const e=this.metadata.posts;return void 0==e?"":e[e.length-1]}lastJob(){const e=this.metadata.jobs;return void 0==e?"":e[e.length-1]}lastHabitation(){const e=this.metadata.habitation;return void 0==e?"":e[e.length-1]}extDes(){let e="";const t=this.metadata;return null!=t.politicalStatus&&(e=e+"【政治面貌】"+t.politicalStatus+"\n"),null!=t.posts&&(e=e+"【历任职务】"+t.posts[t.posts.length-1]+"\n"),null!=t.ext&&null!=t.ext[0].note&&(e=e+"【备注】"+t.ext[0].note+"\n"),e}isSameFamily(){return 1==this.id||void 0!=this.metadata.fatherID}}var K=C,M={data(){return{allPeople:null,rootNode:null}},created(){console.log("tree created");const e=(0,n.f3)("globalVars");return this.allPeople=JSON.parse(JSON.stringify(e.allPeople)),(0,n.YP)((()=>e.allPeople),(e=>{console.log("tree watch"),this.allPeople=JSON.parse(JSON.stringify(e));const t=this.generatePeopleNode(this.allPeople);this.rootNode=t})),{globalVars:e}},mounted(){console.log("tree mounted"),this.rootNode=this.generatePeopleNode(this.allPeople)},methods:{groupByGen:function(e){var t=new Map;for(var l in e){const a=e[l];if(null==a.genID)continue;let n=void 0!=a.fatherID&&0!=a.fatherID;(n||1==a.id)&&(null==t[a.genID]&&(t[a.genID]=new Array),t[a.genID].push(a.id))}return t},peopleIsFamilyOwnerWithID:function(e){if(void 0==e)return!1;let t=this.allPeople[e.toString()],l=new K(t);return l.isFamilyOwner()},generatePeopleNode:function(e){if(void 0==e)return;let t=new Map,l=this.groupByGen(e),a=Object.keys(l).length;for(let n=a;n>0;n--){let a=l[n];for(let l=0;l<a.length;l++){let n=e[a[l].toString()],i={label:n.name,id:n.id,isOwner:this.peopleIsFamilyOwnerWithID(n.id)};if(void 0!=n.children){let e=[];for(let l=0;l<n.children.length;l++)e.push(t[n.children[l]]),delete t[n.children[l]];i["children"]=e}t[n.id]=i}}return t[1]}}};const H=(0,p.Z)(M,[["render",Y]]);var U=H;const Z={key:0},A={style:{"text-align":"left"}},B={key:0},q=(0,n.Uk)("上一代户主： "),G={key:1},Q={key:1};function T(e,t,l,a,i,o){const r=(0,n.up)("router-link"),s=(0,n.up)("el-table-column"),u=(0,n.up)("el-table");return i.family?((0,n.wg)(),(0,n.iD)("div",Z,[(0,n._)("div",A,[(0,n._)("div",null,"赵氏第 "+(0,N.zw)(i.family.owner.genID)+" 代",1),i.family.father?((0,n.wg)(),(0,n.iD)("div",B,[q,(0,n.Wm)(r,{to:{name:"table",query:{id:i.family.father.id}},onClick:t[0]||(t[0]=e=>o.familyOwnerDidClick(i.family.father.id))},{default:(0,n.w5)((()=>[(0,n.Uk)((0,N.zw)(i.family.father.name),1)])),_:1},8,["to"])])):(0,n.kq)("",!0),(0,n._)("div",null,"户主："+(0,N.zw)(i.family.owner.name),1)]),(0,n._)("div",null,[(0,n.Wm)(u,{data:o.tableData,style:{width:"100%"},border:""},{default:(0,n.w5)((()=>[(0,n.Wm)(s,{prop:"name",label:"姓名"},{default:(0,n.w5)((e=>[e.row.id!=this.family.owner.id&&e.row.isFamilyOwner()?((0,n.wg)(),(0,n.j4)(r,{key:0,to:{name:"table",query:{id:e.row.id}},onClick:t=>o.familyOwnerDidClick(e.row.id)},{default:(0,n.w5)((()=>[(0,n.Uk)((0,N.zw)(e.row.name),1)])),_:2},1032,["to","onClick"])):((0,n.wg)(),(0,n.iD)("span",G,(0,N.zw)(e.row.name),1))])),_:1}),(0,n.Wm)(s,{prop:"birthdayDes",label:"生日"}),(0,n.Wm)(s,{prop:"sexDes",label:"性别"}),(0,n.Wm)(s,{prop:"relationship",label:"户主关系"}),(0,n.Wm)(s,{prop:"educational",label:"\t文化程度"}),(0,n.Wm)(s,{prop:"lastJob",label:"从事职业"}),(0,n.Wm)(s,{prop:"nativePlace",label:"籍贯"}),(0,n.Wm)(s,{prop:"lastHabitation",label:"居住地"}),(0,n.Wm)(s,{prop:"spouses",label:"婚姻"}),(0,n.Wm)(s,{prop:"deathdayDes",label:"故时"}),(0,n.Wm)(s,{prop:"extDes",label:"更多"})])),_:1},8,["data"])])])):((0,n.wg)(),(0,n.iD)("div",Q,"数据加载中"))}class E{constructor(e,t){if(null==e||void 0==e||0==Object.keys(e).length)return null;const l=e[t];let a=new K(l);if(null==a||0==a.sex)return null;a.relationship="户主",this.owner=a;var n=null;null!=l.fatherID&&(n=new K(e[l.fatherID.toString()])),this.father=n;var i=null;null!=l.motherID&&(i=new K(e[l.motherID.toString()])),this.mother=i;var o=null;if(null!=l.spouses&&l.spouses.length>0){o=new Array;for(let t=0;t<l.spouses.length;t++){const a=l.spouses[t];let n=new K(e[a.id.toString()]);if(null!=n){n.relationship="夫妻";let e="";null!=a.time&&(e=e+"【时间】"+a.time+"\n"),null!=a.place&&(e=e+"【地址】"+a.place+"\n"),o.push(n)}}}this.marriage=o;var r=null;if(null!=l.children&&l.children.length>0){r=new Array;for(let t=0;t<l.children.length;t++){const a=l.children[t];let n=new K(e[a.toString()]);if(null!=n){if(n.relationship=0==n.metadata.sex?"女":"子",null!=n.metadata.spouses){let t=n.metadata.spouses[n.metadata.spouses.length-1],l="";null!=t.id&&(l=l+"【姓名】"+e[t.id.toString()].name+"\n"),null!=t.time&&(l=l+"【时间】"+t.time+"\n"),null!=t.place&&(l=l+"【地址】"+t.place+"\n"),n.spouses=l}r.push(n)}}}this.children=r}}var L=E,R={data(){return{globalVars:null,family:null}},computed:{tableData:function(){let e=new Array;return e.push(this.family.owner),null!=this.family.marriage&&e.push(...this.family.marriage),null!=this.family.children&&e.push(...this.family.children),e}},created(){console.log("table created");const e=(0,n.f3)("globalVars");return this.globalVars=e,(0,n.YP)((()=>e.allPeople),(()=>{console.log("table watch"),this.updateFamilyByQuery()})),{globalVars:e}},mounted(){console.log("table mounted"),null!=this.allPeople()&&this.updateFamilyByQuery()},methods:{allPeople(){if(Object.keys(this.globalVars.allPeople).length>0){const e=JSON.parse(JSON.stringify(this.globalVars.allPeople));return e}return null},updateFamilyByQuery(){if(void 0==(0,k.yj)())return void console.log("route is null");let e=(0,k.yj)().query.id;void 0==e&&(e="1");const t=this.allPeople();this.family=new L(t,e)},familyOwnerDidClick(e){const t=this.allPeople();this.family=new L(t,e.toString())}}};const $=(0,p.Z)(R,[["render",T]]);var X=$;function ee(e,t,l,a,i,o){const r=(0,n.up)("el-main"),s=(0,n.up)("el-footer"),u=(0,n.up)("el-container"),d=(0,n.up)("el-col"),h=(0,n.up)("el-row"),c=(0,n.up)("el-timeline-item"),p=(0,n.up)("el-timeline");return(0,n.wg)(),(0,n.j4)(p,{style:{"margin-top":"10px"}},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.ancestors,((e,t)=>((0,n.wg)(),(0,n.j4)(c,{key:t},{default:(0,n.w5)((()=>[(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e,((e,t)=>((0,n.wg)(),(0,n.j4)(d,{span:1,key:t},{default:(0,n.w5)((()=>[(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,N.zw)(e.name),1)])),_:2},1024),(0,n.Wm)(s,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,N.zw)(e.deathdayDes),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1})}var te={data(){return{globalVars:null,ancestors:[]}},created(){const e=(0,n.f3)("globalVars");return this.globalVars=e,(0,n.YP)((()=>e.allPeople),(()=>{this.createSacrificeArr()})),{globalVars:e}},mounted(){this.createSacrificeArr()},methods:{allPeople(){if(Object.keys(this.globalVars.allPeople).length>0){const e=JSON.parse(JSON.stringify(this.globalVars.allPeople));return e}return null},createSacrificeArr(){this.ancestors=[];const e=this.allPeople();for(const l in e){const a=e[l];let n=new K(a);if(void 0!=n.genID&&n.isDead()){var t=this.ancestors[n.genID-1];void 0==t?t=[n]:t.push(n),this.ancestors[n.genID-1]=t}}}}};const le=(0,p.Z)(te,[["render",ee]]);var ae=le;const ne=[{path:"/",redirect:"/home"},{path:"/home",name:"home",component:j},{path:"/tree",name:"tree",component:U},{path:"/table",name:"table",component:X},{path:"/sacrifice",name:"sacrifice",component:ae}],ie=(0,k.p7)({history:(0,k.PO)("/genealogy-fe/"),routes:ne});var oe=ie,re=l(1115);(0,a.ri)(v).use(D.Z).use(oe).use(re.Z).mount("#app")}},t={};function l(a){var n=t[a];if(void 0!==n)return n.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,l),i.exports}l.m=e,function(){var e=[];l.O=function(t,a,n,i){if(!a){var o=1/0;for(d=0;d<e.length;d++){a=e[d][0],n=e[d][1],i=e[d][2];for(var r=!0,s=0;s<a.length;s++)(!1&i||o>=i)&&Object.keys(l.O).every((function(e){return l.O[e](a[s])}))?a.splice(s--,1):(r=!1,i<o&&(o=i));if(r){e.splice(d--,1);var u=n();void 0!==u&&(t=u)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[a,n,i]}}(),function(){l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,{a:t}),t}}(),function(){l.d=function(e,t){for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};l.O.j=function(t){return 0===e[t]};var t=function(t,a){var n,i,o=a[0],r=a[1],s=a[2],u=0;if(o.some((function(t){return 0!==e[t]}))){for(n in r)l.o(r,n)&&(l.m[n]=r[n]);if(s)var d=s(l)}for(t&&t(a);u<o.length;u++)i=o[u],l.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return l.O(d)},a=self["webpackChunkgenealogy"]=self["webpackChunkgenealogy"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=l.O(void 0,[998],(function(){return l(5170)}));a=l.O(a)})();
//# sourceMappingURL=app.235ee315.js.map